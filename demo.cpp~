#include <stdlib.h>
#include <string>
#include <iostream>
#include <ctemplate/template.h>
#include <fcgi_stdio.h>
#include <unistd.h>
using namespace std;
int main(int argc, char** argv) {
	
while (FCGI_Accept() >= 0) {  

    	ctemplate::TemplateDictionary dict("example");
    	dict.SetValue("NAME", "John Smith");
    	srand(time(NULL));
    	int winnings = rand() % 100000;
    	dict.SetIntValue("VALUE", winnings);
    	dict.SetFormattedValue("TAXED_VALUE", "%.2f", winnings * 0.83);
    	// For now, assume everyone lives in CA.
    	// (Try running the program with a 0 here instead!)
    	if (1) {
      		dict.ShowSection("IN_CA");
    	}
    	std::string output="Content-type: text/html\r\n \r\n";
    	ctemplate::ExpandTemplate("example.tpl", ctemplate::DO_NOT_STRIP, &dict, &output);
    	std::cout << output << endl;
    }
    return 0;
}



